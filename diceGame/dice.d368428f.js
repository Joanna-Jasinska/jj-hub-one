const e=[{type:"dice",max:"4",min:"1",name:"k4",id:"dicek4"},{type:"dice",max:"6",min:"1",name:"k6",id:"dicek6"},{type:"dice",max:"8",min:"1",name:"k8",id:"dicek8"},{type:"dice",max:"10",min:"1",name:"k10",id:"dicek10"},{type:"dice",max:"12",min:"1",name:"k12",id:"dicek12"},{type:"dice",max:"20",min:"1",name:"k20",id:"dicek20"},{type:"dice",name:"Random Dice",id:"dicerandom"}],t=(e="------------------------------------------------",t=!1)=>(console.log(e),!(!t||!e||"------------------------------------------------"==e)&&e),c={getRandomHexColor:()=>`#${Math.floor(16777215*Math.random()).toString(16).padStart(6,0)}`,getRandom:(e=1,t=1)=>Math.floor(Math.random()*(e+1-t)+t),getRandomDiceMax(e=20,t=4){let c=4,i=20;const n=[4,6,8,10,12,20];return i=n.indexOf(e)+1,c=n.indexOf(t)+1,n[Math.floor(Math.random()*(i+1-c)+c-1)]},getDiceBackgroundColorName(e,t=6,c=1){let i="--dice-bg-color-";return 20==e?i+"mythic":e==c?i+"bad":e==t?i+"perfect":e<=Math.floor((t-c)/5)+c?i+"bad":e>14?i+"epic":e>9?i+"uncommon":i+"medium"}},i={dices:[{id:"dicek20"},{id:"dicek6"},{id:"dicek4"},{id:"dicerandom"},{id:"dicerandom"},{}],items:[{id:"use"},{id:"reroll"},{id:"delete"}]},n={clearData(e=!0){(!e||e&&confirm())&&(log("Clearing local storage"),localStorage.clear())},load(){},save(){},loadObjects(e="dices"){},getIndexFromID:(e="dice",t="")=>0,getObject(e="dice",t=0){},deleteObject(e="dice",t=0){},addObject(e="dice",t=0){},replaceObject(e="dice",t=0,c={}){},getDice(e=0){},overwriteDice(e,t){this.replaceObject("dice",this.getIndexFromID("dice",e),t)},deleteDice(e){this.deleteObject("dice",this.getIndexFromID("dice",e))},loadDices(){this.loadObjects("dices")}},a=(e=[[void 0],void 0])=>{let c=[...e[0]];const i=e[1],n=(e=[])=>(t('action: finished action: "'+e.shift()+'" proceeding with: "'+e[0]+'"'),"action"!=e[0]);switch(t(`action: proceeding with actions: ${c}`),c[0]){case void 0:break;case"deletedices":if(n(c),isNaN(c[0])){let e=document.querySelector(".dice.selected");e&&u.deleteDice(e)}else{for(let e=0;e<parseInt(c[0]);e++){let e=document.querySelector(".dice.selected");u.deleteDice(e)}n(c)}case"deselectdices":if(n(c),isNaN(c[0])){let e=document.querySelector(".dice.selected");for(d in e)u.deselectDice(d)}else for(let e=0;e<parseInt(c[0]);e++){let e=document.querySelector(".dice.selected");u.deselectDice(e)}n(c);case"disabledices":if(n(c),isNaN(c[0])){let e=document.querySelector(".dice.selected");for(d in e)u.deactivateDice(d)}else for(let e=0;e<parseInt(c[0]);e++){let e=document.querySelector(".dice.selected");u.deactivateDice(e)}n(c);case"disableself":m.disableItem(i),n(c);case"rerolldices":if(isNaN(c[0])){t("will reroll all dices");let e=document.querySelectorAll(".dice.selected");for(d of e)t(d),u.rollDice(d,!0)}else for(let e=0;e<parseInt(c[0]);e++){let e=document.querySelector(".dice.selected");u.rollDice(e,!0)}n(c)}return g.clearSelections(),!1},l={fetchDice(t="dicerandom"){for(const c of e)if(c.id==t)return c},generateDices(e){t(`_ng-dices-generate generateDices(${e})`);for(const t of e)this.createDice(t)},findNearestDice(e=!1){const t=document.querySelectorAll(".diceBag .dice");if(!e)return!1;for(d in t)if(u.getDiceID(d)==e)return d;return!1},createDice(e){t("_ng_dices_generate"),t(`fetching dice, id: ${e.id}, dice:`);const i=this.fetchDice(e.id);document.querySelector(".diceBag").append(document.createElement("div"));const n=document.querySelectorAll(".diceBag > div")[document.querySelectorAll(".diceBag > div").length-1];n.classList.add(i.type?i.type:"dice","button"),n.append(document.createElement("div"));const s=n.querySelector("div");s.classList.add("dice__rolled");let a=parseInt(i.max)?parseInt(i.max):c.getRandomDiceMax(),d=c.getRandom(a);s.innerText=`${d}`,n.setAttribute("bgcolor",`${c.getDiceBackgroundColorName(d,a)}`),n.prepend(document.createElement("div"));const l=n.querySelector("div");l.classList.add("dice__max"),l.innerText=`${a}`,n.onclick=e=>{e.preventDefault(),u.clickDice(e.currentTarget)}}},o=[{actions:["disabledices","1","useself","1"],type:"item",name:"Waste\nDice",id:"use"},{type:"item",name:"Reroll\nDice",actions:["rerolldices","1"],reqDice:!0,minDiceAmount:1,maxDiceAmount:1,reqValue:!1,reqExact:!1,minValue:0,maxValue:0,exactValue:0,perTurnUses:1,id:"reroll"},{type:"item",name:"Delete\nDice",actions:["deletedices","1","disableself"],reqDice:!0,minDiceAmount:1,maxDiceAmount:1,reqValue:!1,reqExact:!1,minValue:0,maxValue:0,exactValue:0,perTurnUses:1,id:"delete"}],r={fetchItem(e="use"){for(const t of o)if(t.id==e)return t},createItem(e){const c=document.querySelector(".itemBag");t(`_ng_items: createItem: fetchItem(itemInput.id): ${this.fetchItem(e.id)}`);const i=this.fetchItem(e.id);c.append(document.createElement("div"));const n=document.querySelectorAll(".itemBag > div")[document.querySelectorAll(".itemBag > div").length-1];n.classList.add(i.type?i.type:"item","button"),n.append(document.createElement("div"));const s=n.querySelector("div");s.classList.add("item__name");let a=i.name?i.name:"no\nitem";s.innerText=`${a}`,n.prepend(document.createElement("div"));const d=n.querySelector("div");d.classList.add("item__uses");let l=parseInt(i.perTurnUses)?parseInt(i.perTurnUses):"0";d.innerText=`${l}`,n.setAttribute("code",`${i.id}`),n.onclick=e=>{e.preventDefault(),m.clickItem(e.currentTarget)}},generateItems(e){t(`generateItems(${e})`);document.querySelector(".itemBag");for(const t of e)this.createItem(t)}},m={clickItem(e){t("onItems: clickItem"),this.selectItem(e)&&this.checkActivation(e)&&(t(`onItems: clickItem - activating activateItem(o), o: ${e}`),this.activateItem(e))},getActions:e=>(t("onItems: getActions"),e?(t("o.getAttribute(code): "+e.getAttribute("code")),t(r.fetchItem(e.getAttribute("code")).actions),[r.fetchItem(e.getAttribute("code")).actions,e]):[[0],void 0]),checkActivation(e){const c=document.querySelectorAll(".dice.selected").length;t(`onItems: checkActivation: selected dices: ${c}`),t(e),t(e.actions);const i=this.getActions(e);return!!c&&i;
//!!!aaa!!!
},refreshItem(e){e.classList.contains("inactive")&&e.classList.remove("inactive"),this.deselectItem(e)},activateItem(e){t(),t("onItems: activateItem(o), o:"),t(e),t(),e.classList.contains("item")&&(a(this.checkActivation(e)),g.clearSelections(),this.disableItem(e))},selectItem(e){return!e.classList.contains("item")||e.classList.contains("selected")||e.classList.contains("inactive")?this.deselectItem(e):(e.classList.add("selected"),!0)},deselectItem:e=>(e.classList.contains("selected")&&e.classList.remove("selected"),!1),disableItem(e){e.classList.contains("item")&&!e.classList.contains("inactive")&&(e.classList.add("inactive"),this.deselectItem(e))}},u={clickDice(e){if(e)if(e.classList.contains("selected"))this.deselectDice(e);else{this.selectDice(e);let c=document.querySelectorAll(".itemBag>.item.selected");t(),t("onDices: clickDice(o), selectedItems:"),t(c),t(),c.length>0&&m.checkActivation(c[0])&&(m.activateItem(c[0]),g.clearSelections())}},refreshDice(e){e&&(e.classList.contains("inactive")&&e.classList.remove("inactive"),this.deselectDice(e))},rollDice(e,t=!1){if(!e)return;const i=e.querySelector(".dice__rolled"),n=e.querySelector(".dice__max"),s=parseInt(n.innerText),a=Number(i.innerText);let d=c.getRandom(s);for(;t&&d==a;)d=c.getRandom(s);i.innerText=`${d}`,e.setAttribute("bgcolor",`${c.getDiceBackgroundColorName(d,s)}`),n.innerText=`${s}`},selectDice(e){e&&(e.classList.contains("dice")&&!e.classList.contains("selected")?e.classList.add("selected"):this.deselectDice(e))},deactivateDice(e){e&&e.classList.contains("dice")&&!e.classList.contains("inactive")&&e.classList.add("inactive")},deselectDice(e){e&&e.classList.contains("selected")&&e.classList.remove("selected")},getDiceID:e=>0,deleteDice(e){e&&(n.deleteDice(this.getDiceID(e)),e.remove())}},g={clearDiceBag(){const e=document.querySelector(".diceBag");t("clearDiceBag()"),e.innerText=""},clearItemBag(){const e=document.querySelector(".itemBag");t("clearItemBag()"),e.innerText=""},clearSelections(){const e=document.querySelectorAll(".selected");for(s of e)s.classList.remove("selected")}},D={initiateNewGame(e=newGame){t(`initiateNewGame(newGameState = ${e})`),g.clearItemBag(),g.clearDiceBag(),l.generateDices(e.dices),r.generateItems(e.items),t()}},f={generateMenuButtons(){const e=document.querySelector(".header");t("generateMenuButtons()"),e.append(document.createElement("div"));const c=e.querySelectorAll("div")[e.querySelectorAll("div").length-1];c.classList.add("button-new-game","button"),c.innerText="New\nGame",c.onclick=e=>{e.preventDefault(),D.initiateNewGame(i)},e.append(document.createElement("div"));const n=e.querySelectorAll("div")[e.querySelectorAll("div").length-1];n.classList.add("button-end-turn","button"),n.innerText="End\nTurn",n.onclick=e=>{e.preventDefault();const t=document.querySelectorAll(".dice");for(let e=0;e<t.length;e++)u.refreshDice(t[e]),u.rollDice(t[e]);const c=document.querySelectorAll(".item");for(let e=0;e<c.length;e++)m.refreshItem(c[e])}}};t(),t("-----------page loaded----------"),t(),f.generateMenuButtons(),D.initiateNewGame(i),t(),t("-----------loading finished----------"),t();
//# sourceMappingURL=dice.d368428f.js.map
